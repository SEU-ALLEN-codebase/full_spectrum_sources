# neuron_population
## Usage
### Generation[`./generation`]
Users can get the neurite segmentation simply by runing:

	python calc_brain_statis.py
But before that, you should install two customized filters: `img_pca_filter` and `neuron-image-denoise-py`, simple by:

    python setup.py build_ext --inplace

The generation script takes input of:
- large-scale whole-brain images (ususally in Tera-voxels), in the format of hierarchical TeraFly blocks. 
- threshold file containing the semi-automatically defined thresholds for each brain. We provided examples in this project (`threshold_merged_20230424_fmost1.txt` and `threshold_merged_20230424_fmost2.txt`).
- customized atlas for each brain, which is generated by reverse-mapping from CCFv3 atlas based on registration on 25um CCFv3 atlas.
- *tera\_downsize\_file*: meta information for the atlases and whole-brain images. Should be in *.csv* format.
    

### Analyses[`./analyses`]
1. Plotting the number of neurite voxels and their relationship with number of somas using the scripts `signal.ipynb` and `signal_soma.ipynb`. 
2. Generate modules from the neurite distribution matrix from the *generation* step, using the script module.ipynb. During the process, you should use `module.R` to estimate the pairwise correlations, and cluster the regions, and plot the modules with paraview (`paraview_vtk`). 
- Download and install ParaView based on python3.9 from [https://www.paraview.org/download/](https://www.paraview.org/download/).
- Add "ParaView-5.11.0-Windows-Python3.9-msvc2017-AMD64\bin\Lib\site-packages" to your *PYTHONPATH* or add the following code in paraview\_obj.py and paraview\_vtk.py.

		import sys
		sys.path.append(r'D:\ParaView\ParaView-5.11.0-Windows-Python3.9-msvc2017-AMD64\bin\Lib\site-packages') # use your install directory
- Execute paraview\_obj.py and paraview\_vtk.py in shell or other IDEs and input the input data's directory.

		python paraview_obj.py
		D:/temp_need/paper/classic_region_soma

Exemplar data are provided in the directory `../../data_notebook`.
