# neuron_population
## Usage
### Generation[`./generation`]
Users can get the neurite segmentation simply by runing:

	python calc_brain_statis.py
But before that, you should install two customized filters: `img_pca_filter` and `neuron-image-denoise-py`, simple by:

    python setup.py build_ext --inplace

The generation script takes input of:
- large-scale whole-brain images (ususally in Tera-voxels), in the format of hierarchical TeraFly blocks. 
- threshold file containing the semi-automatically defined thresholds for each brain. We provided examples in this project (`threshold_merged_20230424_fmost1.txt` and `threshold_merged_20230424_fmost2.txt`).
- customized atlas for each brain, which is generated by reverse-mapping from CCFv3 atlas based on registration on 25um CCFv3 atlas.
- *tera\_downsize\_file*: meta information for the atlases and whole-brain images. Should be in *.csv* format.
    

### Analyses[`./analyses`]
1. Most intermediate files and figure components of Figure 2 were produced using the IPython notebook getdata_plot.ipynb, with input files located in ../data/Fig2/assets. The supplementary tables, namely TableS1_SEU-ALLEN_brains_1223_204brains_yx.xlsx and TableS3_Soma_morphometry_1213.xlsx, are available in the paper. Additional essential intermediate files and input files for modile.R and score.R are generated by the getdata_plot.ipynb.

2. To plot the modules with paraview (`paraview_vtk`):
- Download and install ParaView based on python3.9 from [https://www.paraview.org/download/](https://www.paraview.org/download/).
- Add "ParaView-5.11.0-Windows-Python3.9-msvc2017-AMD64\bin\Lib\site-packages" to your *PYTHONPATH* or add the following code in paraview\_obj.py and paraview\_vtk.py.

		import sys
		sys.path.append(r'D:\ParaView\ParaView-5.11.0-Windows-Python3.9-msvc2017-AMD64\bin\Lib\site-packages') # use your install directory
- Execute paraview\_obj.py and paraview\_vtk.py in shell or other IDEs and input the input data's directory.

		python paraview_obj.py
		D:/temp_need/paper/classic_region_soma


